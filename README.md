
# Prerequisites

* python >= 3.11

The dependencies can be installed using pip:
```shell
pip install -r requirements.txt
```

# How to Start Testing NIDS

> We utilize `docker compose` to automate the building of a network topology required for `nidsfuzz` to function. 
> **The biggest problem you might face during setup is your network speed!**

## Network Topology
```text
+----------------+        +------------------+        +-------------------+
| NIDS Initiator | <----> | Gateway & Mirror | <----> | Tunable Responder |
+----------------+        +------------------+        +-------------------+
                             /     |      \ 
                            +      +       +
                   +--------+  +--------+  +----------+  
                   | Snort3 |  | Snort2 |  | Suricata | 
                   +--------+  +--------+  +----------+
                           （Promiscuous Mode）
```

## Usage Tutorial

First, remember to configure the fuzz seed, which is the NIDS rule file:

> 1. **Move the tested rules to the `./benchmark/rules/` folder !**
> 2. **Modify the `SNORT2_RULE_FILE` and `SNORT3_RULE_FILE` parameters in the `docker-compose/variables.env` file accordingly !**

To perform fuzz testing, simply run the `start.sh` script. 

It will check for and build the essential images, including `nidsfuzz`, `mirror`, `snort3`, `suricata`, before starting the fuzzing process.

```shell
bash ./benchmark/start.sh --fuzzing
```

After starting the fuzzing process, you can stop it at any time by executing the `clean.sh` script. 

This script will copy the `alerts\logs` generated by each module and remove all `containers`, `networks`, and `volumes` created during this `Docker Compose` session.

```shell
bash ./benchmark/clean.sh --fuzzing
```

<span style="color: #FF8C00; "> The start.sh and clean.sh scripts can also be used to replay the abnormal test cases found by nidsfuzz to reproduce the inconsistent behavior of different NIDS</span>

```shell
bash ./benchmark/start.sh --replay -packets fuzzing-results/initiator/log
bash ./benchmark/clean.sh --replay
```


## Output Structure
The `clean.sh` will create a folder within the `benchmark` directory. The directory structure is as shown below:
```text
fuzzing-results/
│
├── initiator/
│   └── log/
│       ├── fuzzing.log
│       ├── discrepancies.txt
│       └── packets.bin
│
├── responder/
│   └── log/
│       └── server.log
│ 
├── snort2/
│   └── log/
│       └── snort2.log
│
├── snort3/
│   └── log/
│       └── snort3.log
│
├── suricata/
│   └── log/
│       ├── eve.json
│       ├── fast.log
│       ├── stats.log
│       └── suricata.log
```
